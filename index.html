<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Burger Diary 2026</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-slide-in {
      animation: slideIn 0.3s ease-out;
    }
    
    .toast {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      left: 1rem;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      animation: slideIn 0.3s ease-out;
      text-align: center;
    }
    
    @media (min-width: 640px) {
      .toast {
        left: auto;
        right: 2rem;
        bottom: 2rem;
        max-width: 400px;
      }
    }
    
    .star-rating {
      display: inline-flex;
      gap: 0.25rem;
    }
    
    .star {
      cursor: pointer;
      font-size: 1.25rem;
      transition: transform 0.2s;
    }
    
    @media (min-width: 640px) {
      .star {
        font-size: 1.5rem;
      }
    }
    
    .star:hover {
      transform: scale(1.2);
    }
    
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full">
  <div id="app" class="min-h-full w-full" style="background: linear-gradient(135deg, #FFF8F0 0%, #FFE5D9 100%);"><!-- Navigation -->
   <nav class="w-full shadow-md" style="background-color: #FF6B35;">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex justify-between items-center h-16">
      <div class="flex items-center gap-2"><span class="text-2xl sm:text-3xl">ğŸ”</span>
       <h1 id="app-title" class="text-lg sm:text-xl md:text-2xl font-bold" style="color: #FFFFFF;">Burger Diary 2026</h1>
      </div><!-- Desktop Navigation -->
      <div class="hidden md:flex gap-2 lg:gap-4"><button id="nav-home" onclick="showView('home')" class="nav-btn px-3 lg:px-4 py-2 rounded-lg font-semibold transition-all text-sm lg:text-base" style="color: #FFFFFF; background-color: rgba(255, 255, 255, 0.2);"> Inicio </button> <button id="nav-add" onclick="showView('add')" class="nav-btn px-3 lg:px-4 py-2 rounded-lg font-semibold transition-all text-sm lg:text-base" style="color: #FFFFFF;"> Agregar ğŸ” </button> <button id="nav-list" onclick="showView('list')" class="nav-btn px-3 lg:px-4 py-2 rounded-lg font-semibold transition-all text-sm lg:text-base" style="color: #FFFFFF;"> Registro </button> <button id="nav-recap" onclick="showView('recap')" class="nav-btn px-3 lg:px-4 py-2 rounded-lg font-semibold transition-all text-sm lg:text-base" style="color: #FFFFFF;"> Recap 2026 </button>
      </div><!-- Mobile Menu Button --> <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg" style="color: #FFFFFF;" onclick="toggleMobileMenu()">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
       </svg></button>
     </div><!-- Mobile Navigation Menu -->
     <div id="mobile-menu" class="md:hidden hidden pb-4">
      <div class="flex flex-col gap-2"><button onclick="showView('home'); toggleMobileMenu()" class="nav-btn px-4 py-3 rounded-lg font-semibold transition-all text-left" style="color: #FFFFFF; background-color: rgba(255, 255, 255, 0.1);"> ğŸ  Inicio </button> <button onclick="showView('add'); toggleMobileMenu()" class="nav-btn px-4 py-3 rounded-lg font-semibold transition-all text-left" style="color: #FFFFFF; background-color: rgba(255, 255, 255, 0.1);"> â• Agregar Hamburguesa </button> <button onclick="showView('list'); toggleMobileMenu()" class="nav-btn px-4 py-3 rounded-lg font-semibold transition-all text-left" style="color: #FFFFFF; background-color: rgba(255, 255, 255, 0.1);"> ğŸ“‹ Registro 2026 </button> <button onclick="showView('recap'); toggleMobileMenu()" class="nav-btn px-4 py-3 rounded-lg font-semibold transition-all text-left" style="color: #FFFFFF; background-color: rgba(255, 255, 255, 0.1);"> ğŸ† Recap 2026 </button>
      </div>
     </div>
    </div>
   </nav><!-- Main Content -->
   <main class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><!-- Home View -->
    <div id="home-view" class="view">
     <div class="text-center mb-8">
      <h2 id="welcome-message" class="text-4xl font-bold mb-2" style="color: #8B4513;">Tu diario personal gastronÃ³mico</h2>
      <p class="text-xl" style="color: #A0522D;">RegistrÃ¡ y analizÃ¡ todas las hamburguesas de 2026</p>
     </div>
     <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8">
      <div class="p-4 sm:p-6 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
       <div class="text-center">
        <div class="text-3xl sm:text-4xl mb-2">
         ğŸ”
        </div>
        <div id="total-count" class="text-3xl sm:text-4xl font-bold mb-2" style="color: #FF6B35;">
         0
        </div>
        <div class="text-base sm:text-lg font-semibold" style="color: #8B4513;">
         Hamburguesas comidas
        </div>
       </div>
      </div>
      <div class="p-4 sm:p-6 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
       <div class="text-center">
        <div class="text-3xl sm:text-4xl mb-2">
         â­
        </div>
        <div id="avg-score" class="text-3xl sm:text-4xl font-bold mb-2" style="color: #FFD700;">
         0.0
        </div>
        <div class="text-base sm:text-lg font-semibold" style="color: #8B4513;">
         PuntuaciÃ³n promedio
        </div>
       </div>
      </div>
      <div class="p-4 sm:p-6 rounded-xl shadow-lg sm:col-span-2 lg:col-span-1" style="background-color: #FFFFFF;">
       <div class="text-center">
        <div class="text-3xl sm:text-4xl mb-2">
         ğŸ†
        </div>
        <div id="best-burger" class="text-lg sm:text-xl font-bold mb-2" style="color: #FF6B35;">
         -
        </div>
        <div class="text-base sm:text-lg font-semibold" style="color: #8B4513;">
         Mejor hamburguesa
        </div>
       </div>
      </div>
     </div>
     <div class="text-center"><button onclick="showView('add')" class="px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-lg sm:text-xl font-bold shadow-lg transition-all hover:shadow-xl w-full sm:w-auto" style="background-color: #FF6B35; color: #FFFFFF;"> ğŸ” Registrar una hamburguesa </button>
     </div>
    </div><!-- Add View -->
    <div id="add-view" class="view hidden">
     <div class="max-w-3xl mx-auto p-4 sm:p-6 md:p-8 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
      <h2 class="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 text-center" style="color: #FF6B35;">ğŸ” Nueva Hamburguesa</h2>
      <form id="burger-form" class="space-y-6">
       <div><label for="fecha" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“… Fecha</label> <input type="date" id="fecha" required class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="tipo" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ” Tipo de hamburguesa</label> <select id="tipo" required class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;"> <option value="">Seleccionar...</option> <option value="Gourmet">Gourmet</option> <option value="Fast Food">Fast Food</option> <option value="Casera">Casera</option> <option value="Smash">Smash</option> <option value="Otra">Otra</option> </select>
       </div>
       <div><label for="lugar" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“ Lugar</label> <input type="text" id="lugar" required placeholder="Nombre del local o 'Casa'" class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="medallon" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ¥© Tipo de medallÃ³n</label> <input type="text" id="medallon" required placeholder="Ej: carne vacuna, blend, pollo, veggie..." class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="ingredientes" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ§€ Ingredientes principales</label> <input type="text" id="ingredientes" required placeholder="Ej: cheddar, bacon, cebolla caramelizada..." class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="acompanamiento" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸŸ AcompaÃ±amiento</label> <input type="text" id="acompanamiento" required placeholder="Ej: papas fritas, batatas, nada..." class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="sabor" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ˜‹ Sabor (1-10)</label> <input type="number" id="sabor" required min="1" max="10" step="1" value="5" class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label class="block text-sm font-semibold mb-2" style="color: #8B4513;">â­ PuntuaciÃ³n final</label>
        <div class="star-rating mb-2" id="star-rating"><span class="star" data-value="1">â˜†</span> <span class="star" data-value="2">â˜†</span> <span class="star" data-value="3">â˜†</span> <span class="star" data-value="4">â˜†</span> <span class="star" data-value="5">â˜†</span> <span class="star" data-value="6">â˜†</span> <span class="star" data-value="7">â˜†</span> <span class="star" data-value="8">â˜†</span> <span class="star" data-value="9">â˜†</span> <span class="star" data-value="10">â˜†</span>
        </div><input type="number" id="puntuacion" required min="1" max="10" step="0.1" placeholder="0.0" class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
       </div>
       <div><label for="comentarios" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ’¬ Comentarios personales</label> <textarea id="comentarios" rows="3" placeholder="Â¿QuÃ© te pareciÃ³?" class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;"></textarea>
       </div>
       <div><label for="foto" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“¸ Foto de la hamburguesa</label> <input type="file" id="foto" accept="image/*" class="w-full px-4 py-2 rounded-lg border-2 focus:outline-none focus:border-orange-500" style="border-color: #FFD700;">
        <div id="foto-preview" class="mt-3 hidden"><img id="foto-preview-img" src="" alt="Preview" class="w-full max-h-48 object-cover rounded-lg">
        </div>
       </div>
       <div class="flex flex-col sm:flex-row gap-3 sm:gap-4"><button type="submit" id="submit-btn" class="flex-1 px-4 sm:px-6 py-3 rounded-lg font-bold text-base sm:text-lg transition-all hover:shadow-lg" style="background-color: #FF6B35; color: #FFFFFF;"> ğŸ’¾ Guardar hamburguesa </button> <button type="button" onclick="showView('home')" class="px-4 sm:px-6 py-3 rounded-lg font-bold text-base sm:text-lg transition-all" style="background-color: #D3D3D3; color: #333333;"> Cancelar </button>
       </div>
      </form>
     </div>
    </div><!-- List View -->
    <div id="list-view" class="view hidden">
     <h2 class="text-3xl font-bold mb-6" style="color: #FF6B35;">ğŸ“‹ Registro 2026</h2>
     <div class="mb-4 sm:mb-6 p-3 sm:p-4 rounded-lg" style="background-color: #FFFFFF;">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
       <div><label class="block text-xs sm:text-sm font-semibold mb-1 sm:mb-2" style="color: #8B4513;">Filtrar por tipo</label> <select id="filter-tipo" class="w-full px-3 sm:px-4 py-2 rounded-lg border-2 text-sm sm:text-base" style="border-color: #FFD700;"> <option value="">Todos</option> <option value="Gourmet">Gourmet</option> <option value="Fast Food">Fast Food</option> <option value="Casera">Casera</option> <option value="Smash">Smash</option> <option value="Otra">Otra</option> </select>
       </div>
       <div><label class="block text-xs sm:text-sm font-semibold mb-1 sm:mb-2" style="color: #8B4513;">Filtrar por lugar</label> <input type="text" id="filter-lugar" placeholder="Buscar lugar..." class="w-full px-3 sm:px-4 py-2 rounded-lg border-2 text-sm sm:text-base" style="border-color: #FFD700;">
       </div>
       <div><label class="block text-xs sm:text-sm font-semibold mb-1 sm:mb-2" style="color: #8B4513;">Ordenar por</label> <select id="sort-by" class="w-full px-3 sm:px-4 py-2 rounded-lg border-2 text-sm sm:text-base" style="border-color: #FFD700;"> <option value="fecha-desc">Fecha (reciente)</option> <option value="fecha-asc">Fecha (antigua)</option> <option value="puntuacion-desc">PuntuaciÃ³n â†“</option> <option value="puntuacion-asc">PuntuaciÃ³n â†‘</option> </select>
       </div>
       <div class="flex items-end"><button onclick="clearFilters()" class="w-full px-3 sm:px-4 py-2 rounded-lg font-semibold text-sm sm:text-base" style="background-color: #D3D3D3; color: #333333;"> Limpiar </button>
       </div>
      </div>
     </div>
     <div id="burger-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6"><!-- Burgers will be rendered here -->
     </div>
    </div><!-- Recap View -->
    <div id="recap-view" class="view hidden">
     <h2 class="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 text-center" style="color: #FF6B35;">ğŸ† Recap 2026</h2>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
      <div class="p-4 sm:p-6 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
       <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4" style="color: #8B4513;">ğŸ“Š EstadÃ­sticas Generales</h3>
       <div class="space-y-2 text-sm sm:text-base">
        <p><span class="font-semibold">Total de hamburguesas:</span> <span id="recap-total">0</span></p>
        <p><span class="font-semibold">PuntuaciÃ³n promedio:</span> <span id="recap-avg">0.0</span> â­</p>
        <p><span class="font-semibold">Tipo mÃ¡s consumido:</span> <span id="recap-tipo">-</span></p>
        <p><span class="font-semibold">Local favorito:</span> <span id="recap-lugar">-</span></p>
       </div>
      </div>
      <div class="p-4 sm:p-6 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
       <h3 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4" style="color: #8B4513;">ğŸ¯ DistribuciÃ³n por Tipo</h3>
       <div id="tipo-distribution" class="space-y-2 text-sm sm:text-base"><!-- Distribution will be rendered here -->
       </div>
      </div>
     </div>
     <div class="p-4 sm:p-6 rounded-xl shadow-lg" style="background-color: #FFFFFF;">
      <h3 class="text-xl sm:text-2xl font-bold mb-3 sm:mb-4" style="color: #FF6B35;">ğŸ† Top 5 Hamburguesas del AÃ±o</h3>
      <div id="top-burgers" class="space-y-3 sm:space-y-4"><!-- Top burgers will be rendered here -->
      </div>
     </div>
    </div>
   </main><!-- Edit Modal -->
   <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4" style="display: none;">
    <div class="max-w-3xl w-full p-4 sm:p-6 md:p-8 rounded-xl shadow-2xl overflow-y-auto" style="background-color: #FFFFFF; max-height: 90vh;">
     <h2 class="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6" style="color: #FF6B35;">âœï¸ Editar Hamburguesa</h2>
     <form id="edit-form" class="space-y-4"><input type="hidden" id="edit-id">
      <div><label for="edit-fecha" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“… Fecha</label> <input type="date" id="edit-fecha" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-tipo" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ Tipo</label> <select id="edit-tipo" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;"> <option value="Gourmet">Gourmet</option> <option value="Fast Food">Fast Food</option> <option value="Casera">Casera</option> <option value="Smash">Smash</option> <option value="Otra">Otra</option> </select>
      </div>
      <div><label for="edit-lugar" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“ Lugar</label> <input type="text" id="edit-lugar" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-medallon" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ¥© MedallÃ³n</label> <input type="text" id="edit-medallon" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-ingredientes" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ§€ Ingredientes</label> <input type="text" id="edit-ingredientes" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-acompanamiento" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸŸ AcompaÃ±amiento</label> <input type="text" id="edit-acompanamiento" required class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-sabor" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ï¿½ï¿½ Sabor (1-10)</label> <input type="number" id="edit-sabor" required min="1" max="10" step="1" class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-puntuacion" class="block text-sm font-semibold mb-2" style="color: #8B4513;">â­ PuntuaciÃ³n</label> <input type="number" id="edit-puntuacion" required min="1" max="10" step="0.1" class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
      </div>
      <div><label for="edit-comentarios" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ’¬ Comentarios</label> <textarea id="edit-comentarios" rows="3" class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;"></textarea>
      </div>
      <div><label for="edit-foto" class="block text-sm font-semibold mb-2" style="color: #8B4513;">ğŸ“¸ Foto de la hamburguesa</label> <input type="file" id="edit-foto" accept="image/*" class="w-full px-4 py-2 rounded-lg border-2" style="border-color: #FFD700;">
       <div id="edit-foto-preview" class="mt-3 hidden"><img id="edit-foto-preview-img" src="" alt="Preview" class="w-full max-h-48 object-cover rounded-lg">
       </div>
      </div>
      <div class="flex flex-col sm:flex-row gap-3 sm:gap-4"><button type="submit" id="edit-submit-btn" class="flex-1 px-4 sm:px-6 py-3 rounded-lg font-bold transition-all text-sm sm:text-base" style="background-color: #FF6B35; color: #FFFFFF;"> ğŸ’¾ Guardar cambios </button> <button type="button" onclick="closeEditModal()" class="px-4 sm:px-6 py-3 rounded-lg font-bold text-sm sm:text-base" style="background-color: #D3D3D3; color: #333333;"> Cancelar </button>
      </div>
     </form>
    </div>
   </div>
  </div>
  <script>
    let allBurgers = [];
    let currentEditBurger = null;

    const defaultConfig = {
      app_title: "Burger Diary 2026",
      welcome_message: "Tu diario personal gastronÃ³mico",
      background_color: "#FFF8F0",
      primary_color: "#FF6B35",
      surface_color: "#FFFFFF",
      text_color: "#8B4513",
      accent_color: "#FFD700"
    };

    const dataHandler = {
      onDataChanged(data) {
        allBurgers = data;
        updateHomeStats();
        renderBurgerList();
        updateRecapView();
      }
    };

    async function initApp() {
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          showToast('Error al inicializar la aplicaciÃ³n', 'error');
        }
      }

      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: async (config) => {
            document.getElementById('app-title').textContent = config.app_title || defaultConfig.app_title;
            document.getElementById('welcome-message').textContent = config.welcome_message || defaultConfig.welcome_message;
            
            const appDiv = document.getElementById('app');
            appDiv.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, #FFE5D9 100%)`;
            
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
              btn.style.color = config.surface_color || defaultConfig.surface_color;
            });
            
            document.querySelector('nav').style.backgroundColor = config.primary_color || defaultConfig.primary_color;
          },
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.background_color = value;
                    window.elementSdk.setConfig({ background_color: value });
                  }
                }
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.primary_color = value;
                    window.elementSdk.setConfig({ primary_color: value });
                  }
                }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.surface_color = value;
                    window.elementSdk.setConfig({ surface_color: value });
                  }
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.text_color = value;
                    window.elementSdk.setConfig({ text_color: value });
                  }
                }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  if (window.elementSdk) {
                    window.elementSdk.config.accent_color = value;
                    window.elementSdk.setConfig({ accent_color: value });
                  }
                }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ["app_title", config.app_title || defaultConfig.app_title],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
          ])
        });
      }

      const today = new Date().toISOString().split('T')[0];
      document.getElementById('fecha').value = today;

      setupStarRating();
      setupFormHandlers();
      setupFilters();
      setupImageUpload();
    }

    function setupImageUpload() {
      const fotoInput = document.getElementById('foto');
      const previewContainer = document.getElementById('foto-preview');
      const previewImg = document.getElementById('foto-preview-img');

      fotoInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            previewImg.src = e.target.result;
            previewContainer.classList.remove('hidden');
          };
          reader.readAsDataURL(file);
        } else {
          previewContainer.classList.add('hidden');
        }
      });

      const editFotoInput = document.getElementById('edit-foto');
      const editPreviewContainer = document.getElementById('edit-foto-preview');
      const editPreviewImg = document.getElementById('edit-foto-preview-img');

      editFotoInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            editPreviewImg.src = e.target.result;
            editPreviewContainer.classList.remove('hidden');
          };
          reader.readAsDataURL(file);
        } else {
          editPreviewContainer.classList.add('hidden');
        }
      });
    }

    function setupStarRating() {
      const stars = document.querySelectorAll('#star-rating .star');
      const puntuacionInput = document.getElementById('puntuacion');

      stars.forEach(star => {
        star.addEventListener('click', () => {
          const value = parseInt(star.getAttribute('data-value'));
          puntuacionInput.value = value;
          updateStars(value, stars);
        });

        star.addEventListener('mouseenter', () => {
          const value = parseInt(star.getAttribute('data-value'));
          updateStars(value, stars);
        });
      });

      document.getElementById('star-rating').addEventListener('mouseleave', () => {
        const currentValue = parseInt(puntuacionInput.value) || 0;
        updateStars(currentValue, stars);
      });

      puntuacionInput.addEventListener('input', (e) => {
        const value = Math.floor(parseFloat(e.target.value)) || 0;
        updateStars(value, stars);
      });

      puntuacionInput.addEventListener('change', (e) => {
        const value = parseFloat(e.target.value);
        if (value < 1) e.target.value = 1;
        if (value > 10) e.target.value = 10;
        updateStars(Math.floor(e.target.value), stars);
      });
    }

    function updateStars(rating, starsNodeList) {
      starsNodeList.forEach((star, index) => {
        if (index < rating) {
          star.textContent = 'â˜…';
          star.style.color = '#FFD700';
        } else {
          star.textContent = 'â˜†';
          star.style.color = '#D3D3D3';
        }
      });
    }

    function setupFormHandlers() {
      document.getElementById('burger-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (allBurgers.length >= 999) {
          showToast('Has alcanzado el lÃ­mite de 999 hamburguesas. EliminÃ¡ algunas para continuar.', 'error');
          return;
        }

        // Validar campos
        const sabor = parseInt(document.getElementById('sabor').value);
        const puntuacion = parseFloat(document.getElementById('puntuacion').value);
        
        if (sabor < 1 || sabor > 10) {
          showToast('El sabor debe estar entre 1 y 10', 'error');
          return;
        }
        
        if (puntuacion < 1 || puntuacion > 10) {
          showToast('La puntuaciÃ³n debe estar entre 1 y 10', 'error');
          return;
        }

        const submitBtn = document.getElementById('submit-btn');
        submitBtn.disabled = true;
        submitBtn.textContent = 'â³ Guardando...';

        const fotoInput = document.getElementById('foto');
        let fotoBase64 = '';
        
        if (fotoInput.files && fotoInput.files[0]) {
          const reader = new FileReader();
          await new Promise((resolve) => {
            reader.onload = (e) => {
              fotoBase64 = e.target.result;
              resolve();
            };
            reader.readAsDataURL(fotoInput.files[0]);
          });
        }

        const newBurger = {
          id: Date.now().toString(),
          fecha: document.getElementById('fecha').value,
          tipo: document.getElementById('tipo').value,
          lugar: document.getElementById('lugar').value.trim(),
          medallon: document.getElementById('medallon').value.trim(),
          ingredientes: document.getElementById('ingredientes').value.trim(),
          acompanamiento: document.getElementById('acompanamiento').value.trim(),
          sabor: sabor,
          puntuacion: puntuacion,
          comentarios: document.getElementById('comentarios').value.trim(),
          foto: fotoBase64,
          createdAt: new Date().toISOString()
        };

        if (window.dataSdk) {
          const result = await window.dataSdk.create(newBurger);
          
          if (result.isOk) {
            showToast('ğŸ” Â¡Hamburguesa guardada exitosamente!', 'success');
            document.getElementById('burger-form').reset();
            document.getElementById('foto-preview').classList.add('hidden');
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fecha').value = today;
            document.getElementById('sabor').value = 5;
            const stars = document.querySelectorAll('#star-rating .star');
            updateStars(0, stars);
            
            setTimeout(() => {
              showView('list');
            }, 1500);
          } else {
            showToast('Error al guardar la hamburguesa', 'error');
          }
        }

        submitBtn.disabled = false;
        submitBtn.textContent = 'ğŸ’¾ Guardar hamburguesa';
      });

      document.getElementById('edit-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (!currentEditBurger) return;

        // Validar campos
        const sabor = parseInt(document.getElementById('edit-sabor').value);
        const puntuacion = parseFloat(document.getElementById('edit-puntuacion').value);
        
        if (sabor < 1 || sabor > 10) {
          showToast('El sabor debe estar entre 1 y 10', 'error');
          return;
        }
        
        if (puntuacion < 1 || puntuacion > 10) {
          showToast('La puntuaciÃ³n debe estar entre 1 y 10', 'error');
          return;
        }

        const submitBtn = document.getElementById('edit-submit-btn');
        submitBtn.disabled = true;
        submitBtn.textContent = 'â³ Guardando...';

        const editFotoInput = document.getElementById('edit-foto');
        let fotoBase64 = currentEditBurger.foto;
        
        if (editFotoInput.files && editFotoInput.files[0]) {
          const reader = new FileReader();
          await new Promise((resolve) => {
            reader.onload = (e) => {
              fotoBase64 = e.target.result;
              resolve();
            };
            reader.readAsDataURL(editFotoInput.files[0]);
          });
        }

        const updatedBurger = {
          ...currentEditBurger,
          fecha: document.getElementById('edit-fecha').value,
          tipo: document.getElementById('edit-tipo').value,
          lugar: document.getElementById('edit-lugar').value.trim(),
          medallon: document.getElementById('edit-medallon').value.trim(),
          ingredientes: document.getElementById('edit-ingredientes').value.trim(),
          acompanamiento: document.getElementById('edit-acompanamiento').value.trim(),
          sabor: sabor,
          puntuacion: puntuacion,
          comentarios: document.getElementById('edit-comentarios').value.trim(),
          foto: fotoBase64
        };

        if (window.dataSdk) {
          const result = await window.dataSdk.update(updatedBurger);
          
          if (result.isOk) {
            showToast('âœ… Hamburguesa actualizada exitosamente', 'success');
            closeEditModal();
          } else {
            showToast('Error al actualizar', 'error');
          }
        }

        submitBtn.disabled = false;
        submitBtn.textContent = 'ğŸ’¾ Guardar cambios';
      });
    }

    function setupFilters() {
      document.getElementById('filter-tipo').addEventListener('change', renderBurgerList);
      document.getElementById('filter-lugar').addEventListener('input', renderBurgerList);
      document.getElementById('sort-by').addEventListener('change', renderBurgerList);
    }

    function toggleMobileMenu() {
      const menu = document.getElementById('mobile-menu');
      menu.classList.toggle('hidden');
    }

    function showView(viewName) {
      document.querySelectorAll('.view').forEach(view => view.classList.add('hidden'));
      document.getElementById(`${viewName}-view`).classList.remove('hidden');
      
      // Update active nav button
      document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.style.backgroundColor = '';
      });
      
      const navBtn = document.getElementById(`nav-${viewName}`);
      if (navBtn) {
        navBtn.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';
      }
      
      if (viewName === 'recap') {
        updateRecapView();
      }
      
      if (viewName === 'add') {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('fecha').value = today;
        document.getElementById('burger-form').reset();
        document.getElementById('fecha').value = today;
        document.getElementById('sabor').value = 5;
        document.getElementById('foto-preview').classList.add('hidden');
        const stars = document.querySelectorAll('#star-rating .star');
        updateStars(0, stars);
      }
      
      window.scrollTo(0, 0);
    }

    function updateHomeStats() {
      const totalCount = allBurgers.length;
      const avgScore = totalCount > 0 
        ? (allBurgers.reduce((sum, b) => sum + b.puntuacion, 0) / totalCount).toFixed(1)
        : '0.0';
      
      const bestBurger = totalCount > 0
        ? allBurgers.reduce((best, current) => current.puntuacion > best.puntuacion ? current : best)
        : null;

      document.getElementById('total-count').textContent = totalCount;
      document.getElementById('avg-score').textContent = avgScore;
      document.getElementById('best-burger').textContent = bestBurger 
        ? `${bestBurger.lugar} (${bestBurger.puntuacion}ï¿½ï¿½ï¿½)`
        : '-';
    }

    function renderBurgerList() {
      const container = document.getElementById('burger-list');
      
      let filtered = [...allBurgers];

      const tipoFilter = document.getElementById('filter-tipo').value;
      if (tipoFilter) {
        filtered = filtered.filter(b => b.tipo === tipoFilter);
      }

      const lugarFilter = document.getElementById('filter-lugar').value.toLowerCase();
      if (lugarFilter) {
        filtered = filtered.filter(b => b.lugar.toLowerCase().includes(lugarFilter));
      }

      const sortBy = document.getElementById('sort-by').value;
      filtered.sort((a, b) => {
        switch(sortBy) {
          case 'fecha-desc':
            return new Date(b.fecha) - new Date(a.fecha);
          case 'fecha-asc':
            return new Date(a.fecha) - new Date(b.fecha);
          case 'puntuacion-desc':
            return b.puntuacion - a.puntuacion;
          case 'puntuacion-asc':
            return a.puntuacion - b.puntuacion;
          default:
            return 0;
        }
      });

      if (filtered.length === 0) {
        container.innerHTML = `
          <div class="col-span-full text-center py-12">
            <div class="text-6xl mb-4">ğŸ”</div>
            <p class="text-xl" style="color: #8B4513;">No hay hamburguesas registradas todavÃ­a</p>
          </div>
        `;
        return;
      }

      container.innerHTML = filtered.map(burger => `
        <div class="p-4 sm:p-6 rounded-xl shadow-lg animate-slide-in" style="background-color: #FFFFFF;">
          ${burger.foto ? `<img src="${burger.foto}" alt="${burger.lugar}" class="w-full h-40 sm:h-48 object-cover rounded-lg mb-3 sm:mb-4">` : ''}
          <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2 mb-2">
            <h3 class="text-lg sm:text-xl font-bold" style="color: #FF6B35;">${burger.lugar}</h3>
            <span class="px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold w-fit" style="background-color: #FFE5D9; color: #FF6B35;">${burger.tipo}</span>
          </div>
          <p class="text-xs sm:text-sm mb-2 sm:mb-3" style="color: #A0522D;">ğŸ“… ${new Date(burger.fecha).toLocaleDateString('es-AR')}</p>
          <div class="mb-2 sm:mb-3 text-xs sm:text-sm">
            <p class="truncate"><strong>ğŸ¥©</strong> ${burger.medallon}</p>
            <p class="truncate"><strong>ğŸ§€</strong> ${burger.ingredientes}</p>
            <p class="truncate"><strong>ğŸŸ</strong> ${burger.acompanamiento}</p>
          </div>
          <div class="flex justify-between items-center mb-2 sm:mb-3 text-sm sm:text-base">
            <span class="font-semibold">ğŸ˜‹ ${burger.sabor}/10</span>
            <span class="font-semibold">â­ ${burger.puntuacion}/10</span>
          </div>
          ${burger.comentarios ? `<p class="text-xs sm:text-sm italic mb-3 sm:mb-4 line-clamp-2" style="color: #666;">"${burger.comentarios}"</p>` : ''}
          <div class="flex flex-col sm:flex-row gap-2">
            <button onclick="editBurger('${burger.__backendId}')" class="flex-1 px-3 sm:px-4 py-2 rounded-lg font-semibold transition-all text-sm sm:text-base" style="background-color: #4CAF50; color: #FFFFFF;">
              âœï¸ Editar
            </button>
            <button onclick="deleteBurger('${burger.__backendId}')" class="flex-1 px-3 sm:px-4 py-2 rounded-lg font-semibold transition-all text-sm sm:text-base" style="background-color: #F44336; color: #FFFFFF;">
              ğŸ—‘ï¸ Eliminar
            </button>
          </div>
        </div>
      `).join('');
    }

    function clearFilters() {
      document.getElementById('filter-tipo').value = '';
      document.getElementById('filter-lugar').value = '';
      document.getElementById('sort-by').value = 'fecha-desc';
      renderBurgerList();
    }

    function editBurger(backendId) {
      currentEditBurger = allBurgers.find(b => b.__backendId === backendId);
      if (!currentEditBurger) return;

      document.getElementById('edit-fecha').value = currentEditBurger.fecha;
      document.getElementById('edit-tipo').value = currentEditBurger.tipo;
      document.getElementById('edit-lugar').value = currentEditBurger.lugar;
      document.getElementById('edit-medallon').value = currentEditBurger.medallon;
      document.getElementById('edit-ingredientes').value = currentEditBurger.ingredientes;
      document.getElementById('edit-acompanamiento').value = currentEditBurger.acompanamiento;
      document.getElementById('edit-sabor').value = currentEditBurger.sabor;
      document.getElementById('edit-puntuacion').value = currentEditBurger.puntuacion;
      document.getElementById('edit-comentarios').value = currentEditBurger.comentarios || '';
      
      const editPreviewContainer = document.getElementById('edit-foto-preview');
      const editPreviewImg = document.getElementById('edit-foto-preview-img');
      
      if (currentEditBurger.foto) {
        editPreviewImg.src = currentEditBurger.foto;
        editPreviewContainer.classList.remove('hidden');
      } else {
        editPreviewContainer.classList.add('hidden');
      }

      document.getElementById('edit-modal').style.display = 'flex';
    }

    function closeEditModal() {
      document.getElementById('edit-modal').style.display = 'none';
      document.getElementById('edit-foto-preview').classList.add('hidden');
      document.getElementById('edit-form').reset();
      currentEditBurger = null;
    }

    async function deleteBurger(backendId) {
      const burger = allBurgers.find(b => b.__backendId === backendId);
      if (!burger) return;

      const deleteBtn = event.target;
      const originalText = deleteBtn.innerHTML;
      
      if (deleteBtn.getAttribute('data-confirming') === 'true') {
        deleteBtn.disabled = true;
        deleteBtn.innerHTML = 'â³ Eliminando...';

        if (window.dataSdk) {
          const result = await window.dataSdk.delete(burger);
          
          if (result.isOk) {
            showToast('ğŸ—‘ï¸ Hamburguesa eliminada', 'success');
          } else {
            showToast('Error al eliminar', 'error');
            deleteBtn.disabled = false;
            deleteBtn.innerHTML = originalText;
            deleteBtn.removeAttribute('data-confirming');
          }
        }
      } else {
        deleteBtn.setAttribute('data-confirming', 'true');
        deleteBtn.innerHTML = 'âš ï¸ Â¿Confirmar?';
        deleteBtn.style.backgroundColor = '#FF9800';
        
        setTimeout(() => {
          deleteBtn.removeAttribute('data-confirming');
          deleteBtn.innerHTML = originalText;
          deleteBtn.style.backgroundColor = '#F44336';
        }, 3000);
      }
    }

    function updateRecapView() {
      const total = allBurgers.length;
      const avg = total > 0 ? (allBurgers.reduce((s, b) => s + b.puntuacion, 0) / total).toFixed(1) : '0.0';

      document.getElementById('recap-total').textContent = total;
      document.getElementById('recap-avg').textContent = avg;

      if (total > 0) {
        const tipoCount = {};
        const lugarCount = {};

        allBurgers.forEach(b => {
          tipoCount[b.tipo] = (tipoCount[b.tipo] || 0) + 1;
          lugarCount[b.lugar] = (lugarCount[b.lugar] || 0) + 1;
        });

        const mostCommonTipo = Object.entries(tipoCount).sort((a, b) => b[1] - a[1])[0];
        const mostCommonLugar = Object.entries(lugarCount).sort((a, b) => b[1] - a[1])[0];

        document.getElementById('recap-tipo').textContent = `${mostCommonTipo[0]} (${mostCommonTipo[1]}x)`;
        document.getElementById('recap-lugar').textContent = `${mostCommonLugar[0]} (${mostCommonLugar[1]}x)`;

        const distribution = Object.entries(tipoCount)
          .sort((a, b) => b[1] - a[1])
          .map(([tipo, count]) => {
            const percentage = ((count / total) * 100).toFixed(0);
            return `
              <div>
                <div class="flex justify-between mb-1">
                  <span class="font-semibold">${tipo}</span>
                  <span>${count} (${percentage}%)</span>
                </div>
                <div class="w-full h-3 rounded-full" style="background-color: #FFE5D9;">
                  <div class="h-full rounded-full" style="width: ${percentage}%; background-color: #FF6B35;"></div>
                </div>
              </div>
            `;
          }).join('');

        document.getElementById('tipo-distribution').innerHTML = distribution;

        const topBurgers = [...allBurgers]
          .sort((a, b) => b.puntuacion - a.puntuacion)
          .slice(0, 5)
          .map((burger, index) => `
            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-lg" style="background-color: #FFF8F0;">
              <div class="text-2xl sm:text-3xl font-bold" style="color: #FF6B35;">#${index + 1}</div>
              <div class="flex-1 min-w-0">
                <h4 class="text-base sm:text-lg font-bold truncate" style="color: #8B4513;">${burger.lugar}</h4>
                <p class="text-xs sm:text-sm" style="color: #A0522D;">${burger.tipo} - ${new Date(burger.fecha).toLocaleDateString('es-AR')}</p>
                <p class="text-xs sm:text-sm mt-1 truncate"><strong>ğŸ¥©</strong> ${burger.medallon} | <strong>ğŸ§€</strong> ${burger.ingredientes}</p>
              </div>
              <div class="text-center sm:text-right shrink-0">
                <div class="text-xl sm:text-2xl font-bold" style="color: #FFD700;">â­ ${burger.puntuacion}</div>
                <div class="text-xs sm:text-sm" style="color: #666;">ğŸ˜‹ ${burger.sabor}/10</div>
              </div>
            </div>
          `).join('');

        document.getElementById('top-burgers').innerHTML = topBurgers || '<p class="text-center" style="color: #666;">No hay suficientes datos</p>';
      } else {
        document.getElementById('recap-tipo').textContent = '-';
        document.getElementById('recap-lugar').textContent = '-';
        document.getElementById('tipo-distribution').innerHTML = '<p class="text-center" style="color: #666;">No hay datos para mostrar</p>';
        document.getElementById('top-burgers').innerHTML = '<p class="text-center" style="color: #666;">No hay hamburguesas registradas</p>';
      }
    }

    function showToast(message, type) {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.style.backgroundColor = type === 'success' ? '#4CAF50' : '#F44336';
      toast.style.color = '#FFFFFF';
      toast.textContent = message;
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    document.addEventListener('DOMContentLoaded', initApp);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ba88dd4c7307f30',t:'MTc2Nzg0MjM3NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>